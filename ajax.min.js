function Ajax(e){var t=this;e=e||{};if(!e.url)throw"Ajax needs a url to make the request to";e.method=e.method||"GET";e.data=e.data||"";this.doneCb=undefined;this.failCb=undefined;var n=new XMLHttpRequest;var r=false;n.onreadystatechange=function(){if(this.readyState===4)if(this.status===200||this.status===304){var e=this.response;if(/application\/json/.test(this.getAllResponseHeaders()))e=JSON.parse(e);if(r===false){r=true;if(t.doneCb)t.doneCb(e)}}else{if(r===false){r=true;if(t.failCb)t.failCb({desc:"Status was not 200 or 304",status:this.status})}}};n.open(e.method,e.url,true);if(typeof e.data==="function")throw"Ajax cannot send a function";if(typeof e.data==="object")e.data=JSON.stringify(e.data);n.send(e.data);return this}Ajax.prototype.done=function(e){this.doneCb=e;return this};Ajax.prototype.fail=function(e){this.failCb=e;return this}